# Volumes

In this lab we create bind mounts of existing directories in dot.container quadlet descriptors so they're available in the container. We also create persistent volumes and access them in dot.volume descriptors tying them into container descriptors. We also use ZFS and/or BTRFS to demonstrate how they can be used to archive / rollback changes.

1. Serve existing mkdocs directory with an nginx container
2. Install ZFS
3. Create a test zpool
4. Create a dot.volume on a ZFS mount for the gitea container
5. Automate snapshots with restarts
6. Create a volume snapshot policy manager service

## 0. Snapshot

Since this test runs inside a Vagrant VM, capture a baseline snapshot before making any changes. From your host machine (in the same directory as your Vagrantfile):

```shell
if ! vagrant snapshot list 2>&1 | grep before-volumes >/dev/null; then
  vagrant snapshot save before-volumes;
else
  echo before-volumes snapshot already exists;
fi
```

This allows you to roll the VM back to its exact pre-test state later.

## 1. Serve existing mkdocs directory with a nginx container

